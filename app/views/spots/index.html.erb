<%# === HEAD : Mapbox uniquement sur cette page === %>
<% content_for :mapbox_head do %>
  <link rel="preconnect" href="https://api.mapbox.com" crossorigin>
  <link rel="preconnect" href="https://events.mapbox.com" crossorigin>
  <link rel="dns-prefetch" href="//api.mapbox.com">

  <link rel="preload"
        as="style"
        href="https://api.mapbox.com/mapbox-gl-js/v3.5.1/mapbox-gl.css"
        onload="this.onload=null;this.rel='stylesheet'">
  <noscript>
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/v3.5.1/mapbox-gl.css">
  </noscript>
<% end %>

<div class="workspot-presentation">
  <h1><strong>Les meilleurs spots pour travailler</strong>,<br><em>partout, près de vous...</em></h1>

  <p class="only-desktop">
    Workspots sélectionne pour vous des lieux sympas, accueillants et connectés — cafés,
    restos, hôtels — parfait pour télétravailler, étudier, échanger… ou simplement changer d’air.
  </p>

  <h3 id="spots-map"
      data-controller="spots-count"
      data-spots-count-count-value="<%= @spots_count %>">
    NOS SPOTS SÉLECTIONNÉS POUR VOUS :
  </h3>

  <%# === MAP WRAPPER (une seule .map-shell) === %>
  <div class="map-shell"
       aria-labelledby="spots-map"
       role="region"
       aria-label="Carte interactive des spots de travail"
       data-controller="map"
       data-map-style-value="mapbox://styles/workspots/cmflemqjc007y01secq3x89ng"
       data-map-center-value="[2.3522,48.8566]"
       data-map-zoom-value="11.4">

    <%# Sidebar desktop (une seule) %>
    <aside class="map-sidebar"
           data-map-target="sidebar"
           aria-live="polite"
           aria-label="Fiche café"></aside>

    <%# Carte (une seule, avec un ID unique) %>
    <div id="map"
         class="map"
         data-map-target="container"
         tabindex="0"
         aria-label="Carte des spots">
      <div class="map-placeholder" data-map-target="loading">Chargement…</div>
    </div>

    <%# Bottom sheet mobile (nouveau) %>
    <section class="map-bottomsheet"
             data-map-target="bottomsheet"
             aria-hidden="true">
      <button class="mbs-grabber"
              type="button"
              data-action="click->map#closeBottomSheet"
              aria-label="Fermer le panneau"></button>
      <div class="mbs-content" data-map-target="bottomsheetContent">
        <!-- Contenu du café cliqué injecté ici -->
      </div>
    </section>
  </div>


    <section class="community-share">
    <!-- Contenu textuel -->
    <div class="community-share-content">
      <h1>Des lieux testés et approuvés par la communauté !</h1>
      <p>
        Ici, chaque lieu a été choisi par ceux qui y bossent déjà.
        Wi-Fi, prises, accueil… tout pour travailler tranquille, sans perte de temps.<br>
        Vous en connaissez un autre ? Partagez-le aux Workspoters !
      </p>
    </div>

    <!-- Espace réservé pour un futur carousel -->
    <div class="community-share-carousel-placeholder">
      <!-- Le carousel sera intégré ici plus tard -->
    </div>

    <!-- Bouton CTA -->
    <div class="community-share-contact-card">
      <a class="btn-cta" href="#contact" aria-label="Proposer un spot ou nous contacter">
        Proposer un spot / Nous contacter
      </a>
    </div>
    </section>


          <!-- PACTE DU WORKSPOTTER -->


  <section class="pact">
    <h2>LE PACTE DU BON WORKSPOTTER</h2>
    <p>
      Travailler dans un <strong>Café</strong>, un <strong>Bistrot</strong> bref un <strong>Spot</strong>, <em>c’est une chance</em>.<br>
      Les lieux référencés ici accueillent les workspotters, <span class="underline">tant que le respect est réciproque</span>.
    </p>

<!-- RULES Section -->
            <div class="rules">
          <div class="rule">
            <div class="rule-number">1.</div>
            <div class="rule-text">
              <p><strong>Pensez à vous annoncer</strong><br>en précisant vos intentions</p>
            </div>
          </div>

          <div class="rule">
            <div class="rule-number">2.</div>
            <div class="rule-text">
              <p><strong>Lors du déjeuner</strong><br>Pensez à prendre un repas ou à libérer l’espace</p>
            </div>
          </div>
        </div>
<!--  -->

    <p class="reminder">
      Un problème avec un <strong>Spot</strong> ? <br><span class="underline">Non conforme</span> ou <span class="underline">non respectueux</span> ?
      <br> Écrivez-nous dans la section <strong>Contact</strong>...
    </p>
  </section>
</div>




<section class="contact-section" >
  <div class="contact-box" id="contact">
    <h2 class="contact-title">CONTACTEZ-NOUS...</h2>

    <div class="contact-content">
        <div class="contact-cards">

          <div class="contact-card">
            <h4>Tu veux recommander un spot ?</h4>
            <p>Dis-nous où tu aimes travailler et pourquoi ce lieu mérite sa place ici.</p>
          </div>

          <div class="contact-card">
            <h4>Tu es un commerçant ?</h4>
            <p>Propose ton café ou ton lieu pour accueillir les Workspotters.</p>
          </div>

          <div class="contact-card">
            <h4>Un souci avec un spot ?</h4>
            <p>Signale-nous tout comportement déplacé ou incohérent.</p>
          </div>

          <div class="contact-card">
            <h4>Une idée pour améliorer Workspots?</h4>
            <p>Partage-nous tes suggestions pour rendre le site encore plus utile.</p>
          </div>

        </div>


      <!-- Contact Form -->
        <form action="<%= messages_path %>" method="post" class="contact-form">
        <%= hidden_field_tag :authenticity_token, form_authenticity_token %>

        <input type="text" name="message[name]" placeholder="Prénom Nom..." required />
        <input type="text" name="message[email]" placeholder="Ton adresse email..." required/>
        <input type="text" name="message[establishment]" placeholder="Nom de l’établissement..." />
        <input type="text" name="message[address]" placeholder="Adresse de l’établissement..." />

        <div class="select-wrapper">
          <select name="message[role]">
            <option disabled selected>Je ...</option>
            <option>Je recommande un spot</option>
            <option>Je suis propriétaire d'un spot</option>
            <option>J'ai une remarque à propos d'un spot</option>
            <option>J'ai une autre demande...</option>
          </select>
        </div>

        <textarea name="message[content]" placeholder="Commentaire..."></textarea>

        <button type="submit" class="btn-outline">Envoyez votre commentaire</button>
      </form>
    </div>
  </div>
</section>

<div class="banner about-banner only-desktop">
  <div class="container">
<div class="about">
  <!-- Grille texte 2 colonnes -->
  <div class="about-textgrid">
    <section class="about-copy" aria-labelledby="about-title-1">
      <h2 id="about-title-1" class="about-title">Qui sommes-nous ?</h2>

      <!-- paragraphe d'intro plus lisible -->
      <p class="lead">
        On galérait souvent à trouver un bon spot où bosser tranquillement :<br>
        avant un train, entre deux rendez-vous, ou simplement bien placé.<br>
        Pas le temps de rentrer chez soi. Pas envie d’un Starbucks ni d’une brasserie bondée...
      </p>
      <br >
      <!-- sous-titre visible mais pas un vrai titre -->
      <p id="about-subtitle" class="about-subtitle">Alors on a créé WorkSpots.</p>
      <br >
      <p>
        <strong>Une carte claire et intuitive</strong> qui référence les meilleurs lieux où il fait bon télétravailler : cafés, coffee shop, restaurants, hôtels et même certains coworking...<br>
        Tous adaptés au télétravail, connectés, et ouverts à cette nouvelle façon d’occuper la ville.<br>
        Comme, on est pas les seuls à en avoir besoin,
        on s’est dit qu’on pouvait faire grandir le projet ensemble.
      </p>
      <p><em>Partagez vos lieux préférés ou soufflez-nous vos envies.</em></p>
    </section>

    <section class="about-copy" aria-labelledby="about-title-2">
      <h2 id="about-title-2" class="about-title">Et demain ?</h2>

      <p>
        WorkSpots vise à devenir un réseau vivant...<br>
        Demain, ce sera peut-être :<br>
        → Des lieux partenaires pour recevoir un cours particulier ou un coaching.<br>
        → Des événements ou du networking entre freelances, entrepreneurs...<br>
        → Une carte utile partout en France validées par les usagers.<br>
      </p>
      <p>Vous aimez l’idée ? <br> <strong>Faites-la avancer avec nous.</strong></p>
      <figure class="about-media" aria-hidden="true">
        <%= image_tag "about-us-ws-people.webp", class: "media-img", loading: "lazy", decoding: "async", fetchpriority: "low", alt: "" %>
      </figure>
    </section>
  </div>
</div>



<!-- Bouton d'installation Android -->
<div id="android-instructions" class="android-instructions" style="display:none;">
  <!-- logo Android -->
  <div class="card-logo">
    <%= image_tag "android.svg", alt: "Android", class: "logo-top", loading: "lazy", decoding: "async", fetchpriority: "low", aria: { hidden: true } %>
  </div>

  <h2>Ajoute Workspots sur ton smartphone :</h2>
  <ol>
    <li>
      <div class="step-row">
        <span>Clique sur le bouton ci-dessous</span>
      </div>
    </li>
    <li>
      <div class="step-row">
        <span>Valide l'installation dans la fenêtre</span>
      </div>
    </li>
  </ol>
  <a id="install-button" class="btn install-cta">Ajouter à l'écran d'accueil</a>
</div>

<!-- Conteneur du tuto iOS -->
<div id="ios-instructions" class="ios-instructions"  style="display:none;">
  <!-- logo Apple -->
  <div class="card-logo">
    <%= image_tag "apple.svg", alt: "Apple", class: "logo-top", loading: "lazy", decoding: "async", fetchpriority: "low", aria: { hidden: true } %>
  </div>

  <h2>Ajoute Workspots sur ton smartphone :</h2>
  <ol>
    <li>
      <div class="step-row">
        <span>
          Clique sur <strong>Partager</strong>.
        </span>
        <%= inline_svg_tag "share.svg", alt: "", class: "icon-right icon-share-ios", aria: { hidden: true } %>
      </div>
    </li>
    <li>
      <div class="step-row">
        <span>
          Sélectionne<strong>«Sur l'écran d'accueil»</strong>.
        </span>
        <%= image_tag "add.svg", alt: "", class: "icon-right", loading: "lazy", decoding: "async", fetchpriority: "low", aria: { hidden: true } %>
      </div>
    </li>
    <li>
      <div class="step-row">
        <span>Confirme avec <strong>Ajouter</strong>.</span>
      </div>
    </li>
  </ol>
</div>
  </div>
</div>



    <!--  FOOTER -->


  <footer class="footer">
    <div class="footer-content">
      <div class="footer-left">
        <%= image_tag("logo-ws-white.webp", alt: "Workspot Logo", class: "footer-logo", loading: "lazy", decoding: "async", fetchpriority: "low") %>
      </div>

      <div class="footer-center">
      <!-- SOCIAL FOOTER À FAIRE-->
        <div class="footer-social">
          <%= link_to "https://www.facebook.com/workspotfr", target: "_blank", rel: "noopener" do %>
            <%= image_tag "facebook.svg", alt: "Facebook", class: "social-icon", loading: "lazy", decoding: "async", fetchpriority: "low" %>
          <% end %>

          <%= link_to "https://www.instagram.com/workspotfr", target: "_blank", rel: "noopener" do %>
            <%= image_tag "instagram.svg", alt: "Instagram", class: "social-icon", loading: "lazy", decoding: "async", fetchpriority: "low" %>
          <% end %>

          <%= link_to "https://www.linkedin.com/company/workspotfr", target: "_blank", rel: "noopener" do %>
            <%= image_tag "linkedin.svg", alt: "LinkedIn", class: "social-icon", loading: "lazy", decoding: "async", fetchpriority: "low" %>
          <% end %>
        </div>
        <!-- SOCIAL FOOTER À FAIRE  -->

      </div>

      <div class="footer-right">
        <p><a href="mailto:contact@workspots.fr">contact@workspots.fr</a></p>
      </div>
    </div>
  </footer>
